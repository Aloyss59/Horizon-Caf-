<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Connexion & Inscription - Horizon Café</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
/* RESET & BASE */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Montserrat','Roboto',sans-serif;}
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Roboto:wght@400;500;700&display=swap');

body{background:#1a1a1a;color:#e0e0e0;line-height:1.6;overflow-x:hidden;display:flex;flex-direction:column;min-height:100vh;}
h1,h2,h3{font-weight:700;color:#ffffff;}
p{font-size:0.95rem;color:#b0b0b0;}
a{text-decoration:none;color:inherit;}

/* MAIN WRAPPER */
main{flex:1;display:flex;align-items:center;justify-content:center;padding:2rem;}

/* NAVBAR */
.navbar{width:100%;background:#0a0a0a;padding:0.8rem 2rem;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:1000;box-shadow:0 0 30px rgba(0,210,255,0.3), 0 4px 12px rgba(0,0,0,0.8);border-bottom:2px solid #00d2ff;}
.navbar .logo h2{color:#ffffff;font-size:1.5rem;font-weight:800;font-family:'Montserrat',sans-serif;text-shadow:0 0 10px #00d2ff, 0 0 20px #00d2ff, 0 0 30px #0099cc;letter-spacing:2px;}
.btn-theme-toggle{background:transparent;border:2px solid #00d2ff;color:#00d2ff;padding:0.6rem 0.9rem;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:transform 0.3s ease, box-shadow 0.3s ease;font-size:1.1rem;position:relative;overflow:hidden;box-shadow:0 0 10px rgba(0,210,255,0.3);}
.btn-theme-toggle:hover{background:rgba(0,210,255,0.15);transform:scale(1.15);box-shadow:0 0 20px rgba(0,210,255,0.6);}

/* AUTH CONTAINER */
.auth-container{max-width:500px;width:100%;padding:2rem;background:#0f0f0f;border:1px solid #2a2a2a;border-radius:12px;box-shadow:0 0 30px rgba(0,210,255,0.15);}

.auth-tabs{display:flex;gap:1rem;margin-bottom:2rem;border-bottom:2px solid #2a2a2a;}

.auth-tab{flex:1;padding:1rem;background:transparent;border:none;border-bottom:3px solid transparent;color:#b0b0b0;font-weight:bold;cursor:pointer;transition:all 0.3s;font-size:1rem;}

.auth-tab.active{color:#00d2ff;border-bottom-color:#00d2ff;}

.auth-content{display:none;animation:fadeIn 0.3s ease;}
.auth-content.active{display:block;}

@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}

.form-group{margin-bottom:1.5rem;}

.form-group label{display:block;font-weight:bold;color:#e0e0e0;margin-bottom:0.5rem;}

.form-group input{width:100%;padding:0.8rem;background:rgba(0,210,255,0.05);border:1px solid rgba(0,210,255,0.2);border-radius:6px;color:#e0e0e0;font-size:1rem;transition:all 0.3s;}

.form-group input::placeholder{color:#666;}

.form-group input:focus{outline:none;border-color:#00d2ff;background:rgba(0,210,255,0.1);box-shadow:0 0 15px rgba(0,210,255,0.2);}

.form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem;}

.btn-submit{width:100%;padding:0.8rem;background:linear-gradient(135deg,#00d2ff,#00ff88);color:#000;border:none;border-radius:6px;font-weight:bold;font-size:1rem;cursor:pointer;transition:all 0.3s;box-shadow:0 0 20px rgba(0,210,255,0.3);}

.btn-submit:hover{background:#00ffff;transform:translateY(-2px);box-shadow:0 0 30px rgba(0,210,255,0.5);}

.btn-submit:disabled{opacity:0.6;cursor:not-allowed;transform:none;}

.error{color:#ff6b4a;font-size:0.9rem;margin-top:0.5rem;display:none;}

.error.show{display:block;}

.success{background:rgba(0,255,136,0.1);border:1px solid rgba(0,255,136,0.3);color:#00ff88;padding:1rem;border-radius:6px;margin-bottom:1rem;display:none;}

.success.show{display:block;}

.back-link{text-align:center;margin-top:1.5rem;}

.back-link a{color:#00d2ff;text-decoration:none;font-weight:bold;}

.back-link a:hover{text-decoration:underline;}

/* FOOTER */
footer{background:#0a0a0a;color:#888;padding:2rem;text-align:center;border-top:2px solid #00d2ff;box-shadow:0 0 20px rgba(0,210,255,0.2);font-size:0.9rem;margin-top:auto;}
.footer-bottom{text-align:center;padding:0;}
footer p{color:#888;margin:0;}
footer i{color:#00d2ff;}

/* LIGHT MODE */
body.light-mode{background:#fafaf8;color:#2c2c2c;}
body.light-mode h1,body.light-mode h2,body.light-mode h3{color:#1a1a1a;}
body.light-mode p{color:#555555;}
body.light-mode .navbar{background:linear-gradient(135deg,#ffffff,#f9f6f3);border-bottom-color:#ff6b4a;}
body.light-mode .navbar .logo h2{color:#ff6b4a;text-shadow:0 0 15px rgba(255,107,74,0.3);}
body.light-mode .btn-theme-toggle{border-color:#ff9b7a;color:#ff6b4a;background:rgba(255,107,74,0.05);}
body.light-mode .btn-theme-toggle:hover{border-color:#ff6b4a;background:rgba(255,107,74,0.1);}
body.light-mode .auth-container{background:#ffffff;border-color:#ffd4a0;box-shadow:0 0 15px rgba(255,107,74,0.1);}
body.light-mode .auth-tabs{border-bottom-color:#ffd4a0;}
body.light-mode .auth-tab{color:#555;}
body.light-mode .auth-tab.active{color:#ff6b4a;border-bottom-color:#ff6b4a;}
body.light-mode .form-group label{color:#2c2c2c;}
body.light-mode .form-group input{background:rgba(255,107,74,0.05);border-color:rgba(255,107,74,0.2);color:#2c2c2c;}
body.light-mode .form-group input:focus{border-color:#ff6b4a;background:rgba(255,107,74,0.1);box-shadow:0 0 15px rgba(255,107,74,0.2);}
body.light-mode .btn-submit{background:linear-gradient(135deg,#ff6b4a,#ff9b7a);color:#ffffff;box-shadow:0 0 20px rgba(255,107,74,0.3);}
body.light-mode .btn-submit:hover{background:#ff4a20;box-shadow:0 0 30px rgba(255,107,74,0.5);}
body.light-mode .error{color:#d32f2f;}
body.light-mode .success{background:rgba(46,125,50,0.1);border-color:rgba(46,125,50,0.3);color:#2e7d32;}
body.light-mode .back-link a{color:#ff6b4a;}
body.light-mode footer{background:#ffffff;border-top-color:#ff6b4a;}
body.light-mode footer p{color:#555;}
body.light-mode footer i{color:#ff6b4a;}

/* RESPONSIVE */
@media(max-width:768px){
.navbar{padding:0.8rem 1rem;}
.navbar .logo h2{font-size:1.2rem;}
main{padding:1rem;}
.auth-container{padding:1.5rem;}
.form-row{grid-template-columns:1fr;}
}

@media(max-width:480px){
.auth-container{margin:0.5rem;padding:1rem;}
.btn-submit{padding:0.8rem 1.5rem;font-size:0.95rem;}
}
  </style>
</head>
<body>
<!-- NAVBAR -->
<nav class="navbar">
    <div class="logo"><h2>Horizon Café</h2></div>
    <button class="btn-theme-toggle" id="themeToggle" title="Basculer le mode">
        <i class="fas fa-moon"></i>
    </button>
</nav>

<main>
  <div class="auth-container">
    <div class="auth-tabs">
      <button class="auth-tab active" data-tab="login">Connexion</button>
      <button class="auth-tab" data-tab="register">S'Inscrire</button>
    </div>

    <!-- LOGIN -->
    <div id="login" class="auth-content active">
      <h2 style="margin-bottom: 1.5rem;">Se Connecter</h2>

      <form id="loginForm">
        <div class="form-group">
          <label for="loginEmail">Email</label>
          <input type="email" id="loginEmail" required placeholder="votre@email.com">
          <div class="error" id="loginEmailError"></div>
        </div>

        <div class="form-group">
          <label for="loginPassword">Mot de passe</label>
          <input type="password" id="loginPassword" required placeholder="Votre mot de passe">
          <div class="error" id="loginPasswordError"></div>
        </div>

        <button type="submit" class="btn-submit">Se Connecter</button>

        <div class="error" id="loginError"></div>
      </form>
    </div>

    <!-- REGISTER -->
    <div id="register" class="auth-content">
      <h2 style="margin-bottom: 1.5rem;">Créer un Compte</h2>

      <div class="success" id="registerSuccess">
        Inscription réussie! Vous pouvez maintenant vous connecter.
      </div>

      <form id="registerForm">
        <div class="form-row">
          <div class="form-group">
            <label for="firstName">Prénom</label>
            <input type="text" id="firstName" placeholder="Jean">
            <div class="error" id="firstNameError"></div>
          </div>

          <div class="form-group">
            <label for="lastName">Nom</label>
            <input type="text" id="lastName" placeholder="Dupont">
            <div class="error" id="lastNameError"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="registerEmail">Email</label>
          <input type="email" id="registerEmail" required placeholder="votre@email.com">
          <div class="error" id="registerEmailError"></div>
        </div>

        <div class="form-group">
          <label for="registerUsername">Nom d'utilisateur</label>
          <input type="text" id="registerUsername" required placeholder="jean_dupont">
          <div class="error" id="registerUsernameError"></div>
        </div>

        <div class="form-group">
          <label for="registerPassword">Mot de passe (min. 6 caractères)</label>
          <input type="password" id="registerPassword" required placeholder="••••••">
          <div class="error" id="registerPasswordError"></div>
        </div>

        <div class="form-group">
          <label for="registerPassword2">Confirmer le mot de passe</label>
          <input type="password" id="registerPassword2" required placeholder="••••••">
          <div class="error" id="registerPassword2Error"></div>
        </div>

        <button type="submit" class="btn-submit">S'Inscrire</button>

        <div class="error" id="registerError"></div>
      </form>
    </div>

    <div class="back-link">
      <a href="/">← Retour à l'Accueil</a>
    </div>
  </div>
</main>

  <script>
    const API_URL = 'http://localhost:5000/api';

    // Tabs
    document.querySelectorAll('.auth-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        const tabName = tab.dataset.tab;
        
        document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.auth-content').forEach(c => c.classList.remove('active'));
        
        tab.classList.add('active');
        document.getElementById(tabName).classList.add('active');
        
        clearErrors();
      });
    });

    // LOGIN
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      clearErrors();

      const email = document.getElementById('loginEmail').value.trim();
      const password = document.getElementById('loginPassword').value;
      const btn = e.target.querySelector('button');

      if (!email || !password) {
        showError('loginError', 'Veuillez remplir tous les champs');
        return;
      }

      btn.disabled = true;

      try {
        const res = await fetch(`${API_URL}/auth/login`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });

        const data = await res.json();

        if (res.ok) {
          localStorage.setItem('authData', JSON.stringify({ token: data.token }));
          localStorage.setItem('user', JSON.stringify(data.user));
          window.location.href = 'home.html';
        } else {
          showError('loginError', data.error || 'Erreur de connexion');
        }
      } catch (err) {
        showError('loginError', 'Erreur serveur');
      } finally {
        btn.disabled = false;
      }
    });

    // REGISTER
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      clearErrors();

      const firstName = document.getElementById('firstName').value.trim();
      const lastName = document.getElementById('lastName').value.trim();
      const email = document.getElementById('registerEmail').value.trim();
      const username = document.getElementById('registerUsername').value.trim();
      const password = document.getElementById('registerPassword').value;
      const password2 = document.getElementById('registerPassword2').value;
      const btn = e.target.querySelector('button');

      // Validation
      if (!email || !username || !password) {
        showError('registerError', 'Veuillez remplir tous les champs');
        return;
      }

      if (password.length < 6) {
        showError('registerPasswordError', 'Le mot de passe doit faire au moins 6 caract�res');
        return;
      }

      if (password !== password2) {
        showError('registerPassword2Error', 'Les mots de passe ne correspondent pas');
        return;
      }

      if (!isValidEmail(email)) {
        showError('registerEmailError', 'Email invalide');
        return;
      }

      btn.disabled = true;

      try {
        const res = await fetch(`${API_URL}/auth/register`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ firstName, lastName, email, username, password })
        });

        const data = await res.json();

        if (res.ok) {
          document.getElementById('registerSuccess').classList.add('show');
          document.getElementById('registerForm').style.display = 'none';
          
          setTimeout(() => {
            document.querySelector('[data-tab="login"]').click();
            document.getElementById('loginEmail').value = email;
          }, 2000);
        } else {
          showError('registerError', data.error || 'Erreur lors de l\'inscription');
        }
      } catch (err) {
        showError('registerError', 'Erreur serveur');
      } finally {
        btn.disabled = false;
      }
    });

    function showError(id, msg) {
      const el = document.getElementById(id);
      el.textContent = msg;
      el.classList.add('show');
    }

    function clearErrors() {
      document.querySelectorAll('.error').forEach(el => {
        el.classList.remove('show');
        el.textContent = '';
      });
    }

    function isValidEmail(email) {
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    // THEME TOGGLE
    const themeToggle = document.getElementById('themeToggle');
    const isDarkMode = localStorage.getItem('theme') === 'dark' || !localStorage.getItem('theme');
    if(!isDarkMode){document.body.classList.add('light-mode');updateThemeIcon();}
    themeToggle.addEventListener('click',()=>{
        document.body.classList.toggle('light-mode');
        const isLight = document.body.classList.contains('light-mode');
        localStorage.setItem('theme',isLight?'light':'dark');
        updateThemeIcon();
    });
    function updateThemeIcon(){
        const icon = themeToggle.querySelector('i');
        const isLight = document.body.classList.contains('light-mode');
        icon.className = isLight?'fas fa-sun':'fas fa-moon';
    }
  </script>

  <!-- FOOTER -->
  <footer>
    <div class="footer-bottom">
      <p>&copy; 2025 Horizon Café. Tous droits réservés. <i class="fas fa-coffee"></i></p>
    </div>
  </footer>
</body>
</html>

